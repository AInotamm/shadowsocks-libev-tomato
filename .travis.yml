sudo: false
language: c
env:
  global:
    - MERLIN_VERSION=380.62_1
    - OPENSSL_VERSION=1.0.1u
    - POLARSSL_VERSION=1.2.19-gpl
    - MBEDTLS_VERSION=2.3.0-gpl
    - SHADOWSOCKS_LIBEV_VERSION=2.5.6
  matrix:
    - CRYPTO_LIBRARY=openssl TOOLCHAIN=merlin
    - CRYPTO_LIBRARY=polarssl TOOLCHAIN=merlin
    - CRYPTO_LIBRARY=mbedtls TOOLCHAIN=merlin

cache:
  directories:
    - $HOME/CACHE
script: make install TOOLCHAIN=${TOOLCHAIN} MERLIN_VERSION=${MERLIN_VERSION} SHADOWSOCKS_LIBEV_VERSION=${SHADOWSOCKS_LIBEV_VERSION} CRYPTO_LIBRARY=${CRYPTO_LIBRARY} OPENSSL_VERSION=${OPENSSL_VERSION} POLARSSL_VERSION=${POLARSSL_VERSION} MBEDTLS_VERSION=${MBEDTLS_VERSION}
addons:
  apt:
    packages:
      - autoconf
      - automake
      - bison
      - bzip2
      - diffutils
      - flex
      - m4
      - build-essential
      - gawk
      - groff-base
      - libtool
      - libslang2
      - make
      - patch
      - perl
      - pkg-config
      - shtool
      - texinfo
      - zlib1g-dev
      - gettext
      - libexpat1-dev
      - libssl-dev
      - gperf
      - python
      - libxml-parser-perl
      - gcc-multilib
      - libxml2-dev
      - g++-4.4
      - g++-multilib
      - libncurses5-dev
      - libstdc++6-4.4-dev
      - libvorbis-dev
      - g++-4.4-multilib
      - autopoint
      - autogen
      - sed
      - intltool
      - libelf1:i386
      - libglib2.0-dev
      - lib32z1-dev
      - lib32stdc++6
      - wget
